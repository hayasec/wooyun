
        <html>
			<head><link rel="stylesheet" type="text/css" href="../stylesheets/stylesheet.css" media="screen"><link rel="stylesheet" type="text/css" href="../stylesheets/github-dark.css" media="screen"><link rel="stylesheet" type="text/css" href="../stylesheets/print.css" media="print"><style type="text/css">body {width: 90%;max-width: 960px;display: block;margin: 0 auto;}img {max-width: 900px;}</style>
			     <title>Linux服务器应急事件溯源报告 - 小博博</title>
				 <meta http-equiv="content-type" content="text/html; charset=UTF-8">
			</head>
			<body>
				<h1>原文地址:<a href="http://drops.wooyun.org/tips/12972">http://drops.wooyun.org/tips/12972</a></h1>
				
      <p>
        <p><strong>Author:Inn0team</strong></p>

<h1>0x00 目录</h1>

<ul>
<li>关于目标环境的中间进度检测报告</li>
<li>一：情况概述 </li>
<li>二：取证情况<br />

<ul>
<li>2.1 目标网络情况 </li>
<li>2.2 针对xxx服务器中间件的检测</li>
<li>2.3 针对xxx服务器进程及端口的检测 </li>
<li>2.4 发现攻击者的攻击操作</li>
</ul></li>
<li>三：溯源操作<br />

<ul>
<li>3.1 关于攻击者的反向检测</li>
</ul></li>
<li>四：攻击源确定 

<ul>
<li>4.1 确定攻击入口处</li>
</ul></li>
<li>五：安全性建议</li>
</ul>

<!--more-->

<h1>关于目标环境的中间进度检测报告</h1>

<h1>0x01 情况概述</h1>

<hr />

<p>监控软件监控到服务器存在异常的访问请求，故对此服务器进行安全检查。</p>

<p>通过提供的材料发现内网机器对某公网网站存在异常的访问请求，网络环境存在着异常的网络数据的访问情况。针对其服务器进行综合分析发现了病毒文件两例，内网扫描器两例，通过以上的发现证实服务器已被黑客入侵。</p>

<h1>0x02 取证情况</h1>

<hr />

<h3>2.1 目标网络情况</h3>

<p>下文中的内网内ip以及公网ip为替换后的脱敏ip。</p>

<table>
  <tr>
    <th>
      IP
    </th>
    
    <th>
      所属
    </th>
    
    <th>
      操作系统
    </th>
  </tr>
  
  <tr>
    <td>
      1.168.xxx.xxx
    </td>
    
    <td>
      某业务员服务器
    </td>
    
    <td>
      Linux2.6.32 x86_64操作系统
    </td>
  </tr>
  
  <tr>
    <td>
      192.168.0.0/24
    </td>
    
    <td>
      DMZ区
    </td>
    
    <td>
      Linux&windows
    </td>
  </tr>
  
  <tr>
    <td>
      10.10.0.0/24
    </td>
    
    <td>
      核心区
    </td>
    
    <td>
      Linux&windows
    </td>
  </tr>
  
  <tr>
    <td>
    </td>
    
    <td>
      防火墙
    </td>
    
    <td>
    </td>
  </tr>
</table>

<h3>2.2 针对xxx服务器中间件的检测</h3>

<p>监测存在异常的服务器开放了80端口和21端口，安装了tomcat中间件。首先进行tomcat中间件的排查，查询得知服务器对外开tomcat文件夹路径为<code>/home/XXX/tomcat/XXX _tomcat</code> ，查询tomcat未使用弱密码：</p>

<p><img src="http://static.wooyun.org//drops/20160218/201602180811257760313.png" alt="p1" /> 图1：tomcat未使用默认弱口令</p>

<p>针对tomcat部署服务进行检查，未发现可疑部署组件：</p>

<p><img src="http://static.wooyun.org//drops/20160218/201602180811266312022.png" alt="p2" /> 图2：未发现可疑的部署组件</p>

<p><img src="http://static.wooyun.org//drops/20160218/201602180811288388932.png" alt="p3" /> 图3：未发现可疑的host配置</p>

<h3>2.3 针对xxx服务器进程及端口的检测</h3>

<p>针对目标服务器进行了进程以及端口的检测，发现了可疑现象入下图所示：</p>

<p><img src="http://static.wooyun.org//drops/20160218/201602180811314301641.png" alt="p4" /> 图4:发现可疑占用情况</p>

<p>发现可疑现象后查找“l”所在的路径，入下图所示：</p>

<p><img src="http://static.wooyun.org//drops/20160218/201602180811341325551.png" alt="p5" /> 图5：发现可疑文件路径</p>

<p>在/dev/shm路径下发现存在“l”与“conf.n”文件</p>

<p><img src="http://static.wooyun.org//drops/20160218/201602180811357502861.png" alt="p6" /> 图6：找到可疑文件</p>

<p>将“l”与“conf.n”下载到本地进行分析，“l”程序为inux远控木马Linux.DDOS.Flood.L，经本地分析“l”程序为linux下僵尸木马，同时具有远控的功能</p>

<p><img src="http://static.wooyun.org//drops/20160218/201602180811379492371.png" alt="p7" /> 图7：证实为Linux.DDOS.Flood.L木马</p>

<p>通过继续分析目标服务器中的可以进程与端口占用情况，发现另外可疑文件，如下图所示：</p>

<p><img src="http://static.wooyun.org//drops/20160218/201602180811384924681.png" alt="p8" /> 图8：发现可疑文件vkgdqddsx</p>

<p>将可疑文件进行本地分析，证实此文件为病毒文件：</p>

<p><img src="http://static.wooyun.org//drops/20160218/201602180811401760591.png" alt="p9" /> 图9：证实为病毒文件</p>

<h3>2.4 发现攻击者的攻击操作</h3>

<p>针对目标环境进行彻底排查，发现攻击者使用wget操作从 http://111.205.192.5:2356服务器中下载“l”病毒文件，并执行了“777”加权的操作。</p>

<p>其记录文件如下图所示：</p>

<p><img src="http://static.wooyun.org//drops/20160218/2016021808114285730101.png" alt="p10" /> 图10：发现木马文件下载操作</p>

<p><img src="http://static.wooyun.org//drops/20160218/2016021808114368628111.png" alt="p11" /> 图11：通过l文件的时间状态定位到疑似攻击者下载时间为2015-01-18 04:54:05</p>

<p><img src="http://static.wooyun.org//drops/20160218/2016021808114534911121.png" alt="p12" /> 图12:定位到可疑时间段连接ip地址</p>

<p><img src="http://static.wooyun.org//drops/20160218/2016021808114653846131.png" alt="p13" /> 图13：不同时间段的可疑连接ip</p>

<p>通过进一步的对可疑。</p>

<p>通过分析目标服务器日志文件，发现攻击者下载病毒文件后又使用内网扫描软件“.x”调用其“pascan”和“scanssh”模块进行内网ssh扫描，通过分析发现攻击者收集到了目标网络环境中的常用密码来进行针对性的扫描测试。</p>

<p>如下图所示：</p>

<p><img src="http://static.wooyun.org//drops/20160218/201602180811486789014.png" alt="p14" /> 图14：发现目标服务器中存在ssh爆破以及网段扫描软件</p>

<p><img src="http://static.wooyun.org//drops/20160218/201602180811492422515.png" alt="p15" /> 图15：通过在测试环境中测试发现为扫描软件</p>

<p><img src="http://static.wooyun.org//drops/20160218/201602180811511310816.png" alt="p16" /> 图16：攻击者使用扫描软件进行内网网段的扫描</p>

<p>通过继续对扫描软件进行深入挖掘，发现攻击者使用扫描软件得到的其他内网的ip地址（部分）：</p>

<p><img src="http://static.wooyun.org//drops/20160218/201602180811527964317.png" alt="p17" /> 图：17 攻击者得到的内网部分地址及密码</p>

<p>尝试使用此地址中的192.168.21.231和192.168.21.218进行ssh登录，可使用<code>root:huawei</code>成功进行ssh连接（其他地址及口令不再进行测试），并在内网机器中发现使用弱口令“123456”并发现了同样的“l”病毒文件。</p>

<p>其记录文件如下图所示：</p>

<p><img src="http://static.wooyun.org//drops/20160218/201602180811539439618.png" alt="p18" /> 图18：进行ssh连接</p>

<p><img src="http://static.wooyun.org//drops/20160218/201602180811553633619.png" alt="p19" /> 图19:连接成功后进行“ifconfig”操作</p>

<p><img src="http://static.wooyun.org//drops/20160218/201602180811566599620.png" alt="p20" /> 图：在网络中的其他机器也发现了同样的病毒文件</p>

<p>在扫描器中发现了攻击者使用的“passfile”字典文件，从中可以发现攻击者使用的字典具有很强的针对性（初步断定攻击者为在网络环境中通过查询密码文件等操作获取的相关密码）：</p>

<p><em>隐私信息--此处不贴图</em><br />
图20：发现针对性极强的密码字典</p>

<p>通过继续对日志文件进行排查，发现攻击者使用扫描器进行攻击的历史记录，验证了搜集到的信息：</p>

<p><img src="http://static.wooyun.org//drops/20160218/2016021808115840168211.png" alt="p21" /> 图21：攻击者进行攻击的历史记录</p>

<p>通过即系分析，发现攻击者在进入目标服务器后，又进行了防火墙权限修改、“udf”权限提升、远程连接等其他操作。其中“udf病毒文件”未在目标服务器中发现，在后期进行反追踪中在攻击者服务器中获取到“udf”文件，进行本地检测后病毒文件。</p>

<p>其记录文件如下图所示：</p>

<p><img src="http://static.wooyun.org//drops/20160218/2016021808115921337221.png" alt="p22" /> 图22: 修改iptables防火墙配置</p>

<p><img src="http://static.wooyun.org//drops/20160218/201602180812008786423.png" alt="p23" /> 图23：被修改后的防火墙配置</p>

<p><img src="http://static.wooyun.org//drops/20160218/201602180812026761324.png" alt="p24" /> 图24：攻击者进行提权的操作</p>

<p><img src="http://static.wooyun.org//drops/20160218/201602180812035808525.png" alt="p25" /> 图25：“udf”文件证实为病毒文件</p>

<p>通过对攻击者完整的攻击取证，可证实攻击者通过SSH连接的方式使用<code>guest_cm</code>用户而和<code>root</code>用户进行远程连接，连接之后使用Wget方式下载并种植在目标服务器中“l”和“vkgdqddusx”病毒文件，并使用“udf”进行进一步的权限操作，然后使用“.x”扫描软件配合针对性极强的密码字典进行内网的扫描入侵，并以目标服务器为跳板使用root和xxx账户登录了内网中的其他机器在入侵过程中入侵者将部分相关日志进行了清除操作。</p>

<h1>0x03 溯源操作</h1>

<hr />

<h3>3.1 关于攻击者的反向检测</h3>

<p>在取证过程中发现攻击者服务器使用以下三个ip</p>

<p>xxx.xxx.xxx.x、xxx.xxx.xxx.xxx、xxx.xx.xxx.xx（打个马赛克）</p>

<p>通过对这三个IP进行溯源找到</p>

<p>http://111.205.192.5:2356/ 网站使用hfs服务器搭建，文件服务器内存储着各种病毒文件，其中找到了在“l”“udf”等病毒文件，证实前文中的判断。</p>

<p><img src="http://static.wooyun.org//drops/20160218/201602180812055752526.png" alt="p26" /> 图26：文件服务器中存储着在本次攻击中所使用的病毒文件</p>

<p>通过其他手段查询得知使用ip地址曾绑定 www.xxxx.com网站，并查找出疑似攻击者真实姓名xxx、xxx，<a class="__cf_email__" href="/cdn-cgi/l/email-protection" data-cfemail="997c1c2f7c023b7d240a7d24267e0d31e1e1e1e1e1e1d9e8e8b7faf6f47a1918eef8f7fee3e1e1e1e1e1e1b7e0fcea">[email&#160;protected]</a><script data-cfhash='f9e31' type="text/javascript">/* <![CDATA[ */!function(t,e,r,n,c,a,p){try{t=document.currentScript||function(){for(t=document.getElementsByTagName('script'),e=t.length;e--;)if(t[e].getAttribute('data-cfhash'))return t[e]}();if(t&&(c=t.previousSibling)){p=t.parentNode;if(a=c.getAttribute('data-cfemail')){for(e='',r='0x'+a.substr(0,2)|0,n=2;a.length-n;n+=2)e+='%'+('0'+('0x'+a.substr(n,2)^r).toString(16)).slice(-2);p.replaceChild(document.createTextNode(decodeURIComponent(e)),c)}p.removeChild(t)}}catch(u){}}()/* ]]> */</script>@gmail.com等邮箱，使用61441xx、3675xx等QQ。并通过某种手段深挖得知攻击者同事运营着多个博彩、私服类网站。</p>

<p>其他信息请看下图：</p>

<p><img src="http://static.wooyun.org//drops/20160218/201602180812078567927.png" alt="p27" /> 图27：攻击团伙使用支付宝及姓名</p>

<p><img src="http://static.wooyun.org//drops/20160218/201602180812095203128.png" alt="p28" /> 图28：攻击团伙旗下的其他博彩、私服网站</p>

<p><img src="http://static.wooyun.org//drops/20160218/201602180812122093329.png" alt="p29" /> 图29：攻击者旗下部分博彩、私服网站</p>

<p><em>打码处理</em><br />
图30：攻击团伙成员QQ信息</p>

<h1>0x04 攻击源确定</h1>

<hr />

<h3>4.1 确定攻击入口处</h3>

<p>综合我们对内网多台服务器的日志分析，发现造成本次安全事件的主要原因是：</p>

<p>10.0.xx.xx设备的网络部署存在安全问题，未对其进行正确的网络隔离，导致其ssh管理端口长期暴露在公网上，通过分析ssh登陆日志，该台设备长期遭受ssh口令暴力破解攻击，并发现存在成功暴力破解的日志，攻击者正是通过ssh弱口令获取设备控制权限，并植入木马程序进一步感染内网服务器。</p>

<p>具体攻击流程如下图所示：</p>

<p><img src="http://static.wooyun.org//drops/20160218/201602180812142041930.png" alt="p30" /> 图31：黑客本次攻击流程图</p>

<p><img src="http://static.wooyun.org//drops/20160218/2016021808121620967311.png" alt="p31" /> 图:32：存在长期被爆破的现象</p>

<p><img src="http://static.wooyun.org//drops/20160218/2016021808121718336321.png" alt="p32" /> 图33：被某公网ip爆破成功进入机器</p>

<p>经分析，2016年1月12号公网ip为211.137.38.124的机器使用ssh爆破的方式成功登陆进入10.0.xx.xx机器，之后攻击者以10.0.16.24机器为跳板使用相同的账户登录进入192.168.xxx.xxx机器。</p>

<p><img src="http://static.wooyun.org//drops/20160218/201602180812195756833.png" alt="p33" /> 图34：相同账户进入192.168.150.160机器</p>

<p>攻击者进入192.168.150.160机器后，于2016年1月17日使用wget的方式从http://111.205.192.5:23561网站中下载了 “Linux DDos”木马文件，并使用扫描器对内网进行扫描的操作。</p>

<p><img src="http://static.wooyun.org//drops/20160218/201602180812201307234.png" alt="p34" /> 图：35攻击者下载“Linux DDos”病毒文件</p>

<p>攻击者通过相同的手段在2016年1月17日使用sftp传输的方式进行了木马的扩散行为，详细情况见下图：</p>

<p><img src="http://static.wooyun.org//drops/20160218/201602180812225083035.png" alt="p35" /> 图36:使用SFTP传输的方式进行木马的扩散</p>

<h1>0x05 安全性建议</h1>

<hr />

<ol>
<li>对使用密码字典中的服务器进行密码的更改。</li>
<li>对网络环境进行彻底的整改，关闭不必要的对外端口。 </li>
<li>网络环境已经被进行过内网渗透，还需要及时排查内网机器的安全风险，及时处理。</li>
<li>SSH登录限制<br />
修改sshd配置文件</li>
</ol>

<p>由于服务器较多，防止病毒通过ssh互相传播，可通过修改<code>sshd_config</code>，实现只允许指定的机器连接，方法如下：</p>

<p>登录目标主机，编辑/etc/ssh/sshd_config</p>

<pre><code>#!bash
# vi /etc/ssh/sshd_config
</code></pre>

<p>在文件的最后追加允许访问22端口的主机IP，（IP可用*号通配，但不建议）</p>      </p>
    
			</body>
		</html>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          